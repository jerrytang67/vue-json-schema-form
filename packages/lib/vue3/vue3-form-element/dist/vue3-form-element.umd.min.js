/** @license @ttwork/vue3-form-element (c) 2020-2021 JerryTang License: Apache-2.0 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue"),require("@ttwork/vue3-form-core"),require("@ttwork/vjsf-utils/i18n"),require("@ttwork/vjsf-utils/vue3Utils"),require("@ttwork/vjsf-utils/formUtils"),require("@ttwork/vjsf-utils/schema/validate"),require("@ttwork/vjsf-utils/schema/getDefaultFormState"),require("@ttwork/vjsf-utils/utils")):"function"==typeof define&&define.amd?define(["exports","vue","@ttwork/vue3-form-core","@ttwork/vjsf-utils/i18n","@ttwork/vjsf-utils/vue3Utils","@ttwork/vjsf-utils/formUtils","@ttwork/vjsf-utils/schema/validate","@ttwork/vjsf-utils/schema/getDefaultFormState","@ttwork/vjsf-utils/utils"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).vue3FormElement={},e.Vue,e.createVue3Core,e.i18n,e.vueUtils,e.formUtils,e.validate,e.getDefaultFormState,e.utils)}(this,(function(e,t,o,r,n,l,i,a,s){"use strict";function u(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function c(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(o){if("default"!==o){var r=Object.getOwnPropertyDescriptor(e,o);Object.defineProperty(t,o,r.get?r:{enumerable:!0,get:function(){return e[o]}})}})),t.default=e,Object.freeze(t)}var d=u(o),p=u(r),m=c(n),f=c(l),g=c(i),v=u(a),k={name:"CheckboxesWidget",props:{enumOptions:{default:()=>[],type:[Array]}}};k.render=function(e,o,r,n,l,i){const a=t.resolveComponent("el-checkbox"),s=t.resolveComponent("el-checkbox-group");return t.openBlock(),t.createBlock(s,e.$attrs,{default:t.withCtx(()=>[(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(r.enumOptions,(e,o)=>(t.openBlock(),t.createBlock(a,{key:o,label:e.value},{default:t.withCtx(()=>[t.createTextVNode(t.toDisplayString(e.label),1)]),_:2},1032,["label"]))),128))]),_:1},16)},k.__file="src/config/widgets/CheckboxesWidget/index.vue";var b={name:"RadioWidget",props:{enumOptions:{default:()=>[],type:[Array]}}};b.render=function(e,o,r,n,l,i){const a=t.resolveComponent("el-radio"),s=t.resolveComponent("el-radio-group");return t.openBlock(),t.createBlock(s,e.$attrs,{default:t.withCtx(()=>[(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(r.enumOptions,(e,o)=>(t.openBlock(),t.createBlock(a,{key:o,label:e.value},{default:t.withCtx(()=>[t.createTextVNode(t.toDisplayString(e.label),1)]),_:2},1032,["label"]))),128))]),_:1},16)},b.__file="src/config/widgets/RadioWidget/index.vue";var h={name:"SelectWidget",props:{enumOptions:{default:()=>[],type:[Array]}}};function y(e){return null===e||""===e||Array.isArray(e)&&e.every(e=>""===e)}h.render=function(e,o,r,n,l,i){const a=t.resolveComponent("el-option"),s=t.resolveComponent("el-select");return t.openBlock(),t.createBlock(s,e.$attrs,{default:t.withCtx(()=>[(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(r.enumOptions,(e,o)=>(t.openBlock(),t.createBlock(a,{key:o,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},16)},h.__file="src/config/widgets/SelectWidget/index.vue";const w=e=>{const{year:t,month:o,day:r}=s.parseDateString(e,!1);return`${t}-${o}-${r}`};const C=e=>{if(e instanceof Date)return e;if("string"==typeof e){const[t,o,r]=e.split(":"),n=new Date;return n.setHours(+t),n.setMinutes(+o),n.setSeconds(+r),n}};const x={CheckboxesWidget:k,RadioWidget:b,SelectWidget:h,TimePickerWidget:{name:"TimePickerWidget",inheritAttrs:!1,props:{modelValue:{default:null,type:null}},setup(e,{attrs:o,slots:r}){const l=t.ref(C(e.modelValue));let i=e.modelValue;return t.watch(()=>e.modelValue,e=>{e!==i&&(l.value=C(e))}),()=>t.h(n.resolveComponent("el-time-picker"),{...o,modelValue:l.value,"onUpdate:modelValue":e=>{l.value=e,i=null===e?void 0:(e=>{const{hour:t,minute:o,second:r}=s.parseDateString(e,!0);return`${t}:${o}:${r}`})(e),o["onUpdate:modelValue"].apply(o,[i])}},r)}},DatePickerWidget:{name:"DatePickerWidget",inheritAttrs:!1,setup:(e,{attrs:o,slots:r})=>()=>{const{isNumberValue:e,isRange:l,...i}=o||{};return t.h(n.resolveComponent("el-date-picker"),{type:l?"daterange":"date",...i,"onUpdate:modelValue":t=>{let r;r=l?y(t)?[]:t.map(t=>e?new Date(t).valueOf():w(t)):y(t)?void 0:e?new Date(t).valueOf():w(t),o["onUpdate:modelValue"].apply(o,[r])}},r)}},DateTimePickerWidget:{name:"DateTimePickerWidget",inheritAttrs:!1,setup:(e,{attrs:o,slots:r})=>()=>{const{isNumberValue:e,isRange:l,...i}=o||{};return t.h(n.resolveComponent("el-date-picker"),{type:l?"datetimerange":"datetime",...i,"onUpdate:modelValue":t=>{const r=((e,t,o)=>e?null===o?[]:o.map(e=>new Date(e)[t?"valueOf":"toISOString"]()):null===o?void 0:new Date(o)[t?"valueOf":"toISOString"]())(l,e,t);o["onUpdate:modelValue"].apply(o,[r])}},r)}},UploadWidget:{name:"UploadWidget",props:{modelValue:{default:null,type:[String,Array]},responseFileUrl:{default:()=>e=>e?e.url||e.data&&e.data.url:"",type:[Function]},btnText:{type:String,default:"点击上传"},slots:{type:null,default:null}},setup(e,{attrs:o,emit:r}){const l=e.modelValue,i=Array.isArray(l),a=o.fileList||(i?l.map((e,t)=>({name:`已上传文件（${t+1}）`,url:e})):l?[{name:"已上传文件",url:l}]:[]),u=t.ref(a),c=t=>t&&(t.response&&e.responseFileUrl(t.response)||t.url)||"",d=e=>{let t;if(i)t=e.length?e.reduce((e,t)=>{const o=c(t);return o&&e.push(o),e},[]):[];else{const o=e[e.length-1];t=c(o)}r("update:modelValue",t)},p=t.getCurrentInstance().appContext.config.globalProperties;return()=>{const r={fileList:u.value,"on-exceed":()=>{p.$message&&p.$message.warning("超出文件上传数")},"on-error":()=>{p.$message&&p.$message.error("文件上传失败")},"on-preview":e=>{const t=c(e);t&&s.openNewPage(t)},...o,"on-remove":(e,t)=>{d(t),o["on-remove"]&&o["on-remove"](e,t)},"on-success":(e,t,r)=>{d(r),o["on-success"]&&o["on-success"](e,t,r)}};i||(r.limit=1);const l={default:()=>t.h(n.resolveComponent("el-button"),{type:"primary"},{default:()=>e.btnText}),...e.slots||{}};return t.h(n.resolveComponent("el-upload"),r,l)}}}},{CheckboxesWidget:O,RadioWidget:P,SelectWidget:j,TimePickerWidget:S,DatePickerWidget:W,DateTimePickerWidget:D}=x;var V={types:{boolean:"el-switch",string:"el-input",number:"el-input-number",integer:"el-input-number"},formats:{color:"el-color-picker",time:S,date:W,"date-time":D},common:{select:j,radioGroup:P,checkboxGroup:O},widgetComponents:x};!function(e,t){void 0===t&&(t={});var o=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css","top"===o&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}}(".genFromComponent.el-form--label-top .el-form-item__label{line-height:26px;padding-bottom:6px;font-size:14px}.genFromComponent .el-checkbox,.genFromComponent .el-color-picker{vertical-align:top}");const B={WIDGET_MAP:V,COMPONENT_MAP:{form:t.defineComponent({inheritAttrs:!1,setup(e,{attrs:o,slots:r}){const l=t.ref(null);return o.setFormRef&&t.onMounted(()=>{o.setFormRef(l.value)}),()=>{const{setFormRef:e,...i}=o;return t.h(n.resolveComponent("el-form"),{ref:l,...i},r)}}}),formItem:"el-form-item",button:"el-button",popover:"el-popover"},HELPERS:{isMiniDes:e=>e&&["left","right"].includes(e.labelPosition)}},F=d.default(B);Object.defineProperty(e,"SchemaField",{enumerable:!0,get:function(){return o.SchemaField}}),Object.defineProperty(e,"fieldProps",{enumerable:!0,get:function(){return o.fieldProps}}),Object.defineProperty(e,"i18n",{enumerable:!0,get:function(){return p.default}}),e.vueUtils=m,e.formUtils=f,e.schemaValidate=g,Object.defineProperty(e,"getDefaultFormState",{enumerable:!0,get:function(){return v.default}}),e.default=F,e.globalOptions=B,Object.defineProperty(e,"__esModule",{value:!0})}));
